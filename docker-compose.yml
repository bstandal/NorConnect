services:
  postgres:
    image: postgres:16
    container_name: nongo-postgres
    restart: unless-stopped
    environment:
      POSTGRES_USER: ${POSTGRES_USER:-nongo}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-nongo_dev_password}
      POSTGRES_DB: ${POSTGRES_DB:-nongo}
    ports:
      - "${POSTGRES_PORT:-5432}:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER:-nongo} -d ${POSTGRES_DB:-nongo}"]
      interval: 10s
      timeout: 5s
      retries: 10

  neo4j:
    image: neo4j:5.26
    container_name: nongo-neo4j
    restart: unless-stopped
    environment:
      NEO4J_AUTH: ${NEO4J_USER:-neo4j}/${NEO4J_PASSWORD:-neo4j_dev_password}
      NEO4J_server_memory_heap_initial__size: 512m
      NEO4J_server_memory_heap_max__size: 1g
      NEO4J_server_default__listen__address: 0.0.0.0
    ports:
      - "${NEO4J_HTTP_PORT:-7474}:7474"
      - "${NEO4J_PORT:-7687}:7687"
    volumes:
      - neo4j_data:/data
      - neo4j_logs:/logs

volumes:
  postgres_data:
  neo4j_data:
  neo4j_logs:
